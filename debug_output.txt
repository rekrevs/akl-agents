(lldb) target create "/Users/sverker/gitrepos/akl-agents/emulator/oagents"
Current executable set to '/Users/sverker/gitrepos/akl-agents/emulator/oagents' (arm64).
(lldb) command source -s 0 '/tmp/lldb_commands.txt'
Executing commands in '/tmp/lldb_commands.txt'.
(lldb) # Set up LLDB to stop on the trap
(lldb) process handle SIGTRAP --stop true --pass false --notify true
NAME         PASS     STOP     NOTIFY
===========  =======  =======  =======
SIGTRAP      false    true     true   
(lldb) # Set breakpoints on key GMP-related functions and initialization
(lldb) breakpoint set --name make_bignum
Breakpoint 1: where = oagents`make_bignum, address = 0x0000000100006a9c
(lldb) breakpoint set --name new_bignum
Breakpoint 2: where = oagents`new_bignum, address = 0x0000000100006914
(lldb) breakpoint set --name bignum_gc
Breakpoint 3: where = oagents`bignum_gc, address = 0x0000000100006c9c
(lldb) breakpoint set --name initialize_bignum
Breakpoint 4: where = oagents`initialize_bignum, address = 0x00000001000084e8
(lldb) breakpoint set --name initialize_finite
Breakpoint 5: where = oagents`initialize_finite, address = 0x0000000100028858
(lldb) # Set breakpoints on critical macros and functions
(lldb) breakpoint set --file fd_akl.c --line 986
Breakpoint 6: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --file config.h --line 77
Breakpoint 7: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) # Set breakpoints on GMP functions
(lldb) breakpoint set --name mpz_init
Breakpoint 8: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --name mpz_init_set_si
Breakpoint 9: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --name mpz_clear
Breakpoint 10: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --name mpz_set_si
Breakpoint 11: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) # Set breakpoint on SIGTRAP to catch the exact point of failure
(lldb) process handle SIGTRAP --stop true --pass false --notify true
NAME         PASS     STOP     NOTIFY
===========  =======  =======  =======
SIGTRAP      false    true     true   
(lldb) # Set breakpoints for GMP library functions
(lldb) breakpoint set --name mpz_init
Breakpoint 12: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --name mpz_clear
Breakpoint 13: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --name mpz_set_si
Breakpoint 14: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) breakpoint set --name mpz_get_si
Breakpoint 15: no locations (pending).
WARNING:  Unable to resolve breakpoint to any actual locations.
(lldb) # Set breakpoints for error handling
(lldb) breakpoint set --name error_exit
Breakpoint 16: where = oagents`error_exit, address = 0x000000010001c320
(lldb) # Run the program with arguments
(lldb) run -b /Users/sverker/gitrepos/akl-agents/environment/boot.pam -b /Users/sverker/gitrepos/akl-agents/oldcompiler/comp.pam -b /Users/sverker/gitrepos/akl-agents/version.pam
Process 58679 stopped
* thread #1, queue = 'com.apple.main-thread', stop reason = breakpoint 4.1
    frame #0: 0x00000001000084e8 oagents`initialize_bignum
oagents`initialize_bignum:
->  0x1000084e8 <+0>:  sub    sp, sp, #0x40
    0x1000084ec <+4>:  stp    x20, x19, [sp, #0x20]
    0x1000084f0 <+8>:  stp    x29, x30, [sp, #0x30]
    0x1000084f4 <+12>: add    x29, sp, #0x30
Target 0: (oagents) stopped.
Process 58679 launched: '/Users/sverker/gitrepos/akl-agents/emulator/oagents' (arm64)
(lldb) # When it stops (likely on SIGTRAP), print detailed diagnostic information
(lldb) bt all
* thread #1, queue = 'com.apple.main-thread', stop reason = breakpoint 4.1
  * frame #0: 0x00000001000084e8 oagents`initialize_bignum
    frame #1: 0x000000010002ea84 oagents`initialise + 224
    frame #2: 0x000000010003e3ac oagents`main + 232
    frame #3: 0x0000000186430274 dyld`start + 2840
(lldb) thread backtrace all
* thread #1, queue = 'com.apple.main-thread', stop reason = breakpoint 4.1
  * frame #0: 0x00000001000084e8 oagents`initialize_bignum
    frame #1: 0x000000010002ea84 oagents`initialise + 224
    frame #2: 0x000000010003e3ac oagents`main + 232
    frame #3: 0x0000000186430274 dyld`start + 2840
(lldb) frame variable --show-all-children
(lldb) register read --all
General Purpose Registers:
        x0 = 0x0000000158043bb8
        x1 = 0x0000000000000002
        x2 = 0x0000000158043b80
        x3 = 0x0000000158043b6c
        x4 = 0x0000000000000064
        x5 = 0x000000000000003d
        x6 = 0x0000000000000000
        x7 = 0x0000000000000b00
        x8 = 0x000000010006f850  oagents`tempa
        x9 = 0x000000010005f368  oagents`constcurrent
       x10 = 0x00000001580a4000
       x11 = 0x0000000158042890
       x12 = 0x000000010000005f  oagents`_mh_execute_header + 95
       x13 = 0x0000000000000000
       x14 = 0x0000000000000000
       x15 = 0x00000001000481a1  "AKLCODESIZE"
       x16 = 0x00000001867e443c  libsystem_platform.dylib`_platform_strcpy
       x17 = 0x00000001f8762fe0
       x18 = 0x0000000000000000
       x19 = 0x0000000000000003
       x20 = 0x000000010004963c  "-b"
       x21 = 0x000000010005ccac  oagents`akl_argc
       x22 = 0x000000010006f80c  oagents`pred_protection
       x23 = 0x000000010006f808  oagents`pred_protect
       x24 = 0x000000016fdfef08
       x25 = 0x0000000000000003
       x26 = 0x0000000000000007
       x27 = 0x0000000000000000
       x28 = 0x0000000000000000
        fp = 0x000000016fdfe6a0
        lr = 0x000000010002ea84  oagents`initialise + 224
        sp = 0x000000016fdfe6a0
        pc = 0x00000001000084e8  oagents`initialize_bignum
      cpsr = 0x80001000
        w0 = 0x58043bb8
        w1 = 0x00000002
        w2 = 0x58043b80
        w3 = 0x58043b6c
        w4 = 0x00000064
        w5 = 0x0000003d
        w6 = 0x00000000
        w7 = 0x00000b00
        w8 = 0x0006f850
        w9 = 0x0005f368
       w10 = 0x580a4000
       w11 = 0x58042890
       w12 = 0x0000005f
       w13 = 0x00000000
       w14 = 0x00000000
       w15 = 0x000481a1
       w16 = 0x867e443c
       w17 = 0xf8762fe0
       w18 = 0x00000000
       w19 = 0x00000003
       w20 = 0x0004963c
       w21 = 0x0005ccac
       w22 = 0x0006f80c
       w23 = 0x0006f808
       w24 = 0x6fdfef08
       w25 = 0x00000003
       w26 = 0x00000007
       w27 = 0x00000000
       w28 = 0x00000000

Floating Point Registers:
        v0 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
        v1 = {0x0c 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
        v2 = {0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f}
        v3 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
        v4 = {0xf0 0xf0 0x22 0x58 0x18 0x2b 0x74 0xc0 0xff 0xfc 0x74 0xcc 0xee 0x2b 0xa2 0xc3}
        v5 = {0x4b 0xe4 0xb0 0xad 0xd4 0x44 0xb0 0x2d 0xab 0x1e 0x4f 0x3f 0xf7 0x64 0xe7 0xe3}
        v6 = {0xa7 0xde 0x93 0x45 0xb1 0x56 0x76 0x02 0x85 0x84 0x61 0x97 0xc3 0xda 0xa8 0x5c}
        v7 = {0x22 0x61 0x1f 0xeb 0x77 0xe9 0x33 0x2c 0xdb 0x02 0x65 0xf5 0x17 0x37 0xd5 0x65}
        v8 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
        v9 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v10 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v11 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v12 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v13 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v14 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v15 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v16 = {0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v17 = {0x02 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v18 = {0x0f 0x0e 0x0d 0x0c 0x0b 0x0a 0x09 0x08 0x07 0x06 0x05 0x04 0x03 0x02 0x01 0x00}
       v19 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
       v20 = {0xf0 0xf0 0x22 0x58 0x18 0x2b 0x74 0xc0 0xff 0xfc 0x74 0xcc 0xee 0x2b 0xa2 0xc3}
       v21 = {0x4b 0xe4 0xb0 0xad 0xd4 0x44 0xb0 0x2d 0xab 0x1e 0x4f 0x3f 0xf7 0x64 0xe7 0xe3}
       v22 = {0x64 0x22 0x2d 0x72 0x96 0x9b 0x69 0xe0 0x1f 0x7d 0x72 0xae 0xde 0x12 0x7d 0x7b}
       v23 = {0x24 0x03 0x23 0xc1 0xa1 0x15 0xb0 0x66 0x33 0xa6 0xef 0xad 0xb2 0x03 0xf6 0xe6}
       v24 = {0x80 0x57 0x75 0xeb 0xf9 0x9f 0x9d 0xb3 0x50 0x7c 0x01 0xd5 0x38 0xaf 0x54 0x16}
       v25 = {0x1f 0xbd 0xac 0x0d 0xe0 0x91 0x94 0x30 0x00 0x26 0xba 0x65 0xba 0xd8 0x42 0xd8}
       v26 = {0xc4 0x62 0x0c 0xe0 0xb2 0x56 0xc3 0x8b 0xb9 0x8e 0xf4 0x99 0xf5 0xbf 0x62 0xdd}
       v27 = {0x0a 0xce 0x19 0xb3 0xf1 0xa1 0x91 0x64 0x54 0x19 0x44 0x22 0xbe 0xfc 0xc4 0x3c}
       v28 = {0x44 0xaa 0x09 0x33 0xb0 0x62 0xf5 0x04 0xac 0x67 0xc5 0x40 0x92 0x23 0x9f 0xc3}
       v29 = {0x6c 0x43 0x9b 0xbe 0x7f 0x26 0x1c 0x11 0xe6 0x39 0x02 0x58 0x0b 0x82 0xca 0xdb}
       v30 = {0x5a 0xb7 0xb9 0xc2 0xaa 0xa9 0x5a 0x4b 0xa4 0xb5 0x43 0xa5 0xc7 0x40 0x8d 0xcf}
       v31 = {0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00}
      fpsr = 0x00000000
      fpcr = 0x00000000
        s0 = 0
        s1 = 1.68155816E-44
        s2 = 3.82047143E-37
        s3 = 0
        s4 = 7.16622809E+14
        s5 = -2.01102659E-11
        s6 = 4731.83154
        s7 = -1.92677902E+26
        s8 = 0
        s9 = 0
       s10 = 0
       s11 = 0
       s12 = 0
       s13 = 0
       s14 = 0
       s15 = 0
       s16 = 1.40129846E-45
       s17 = 2.80259693E-45
       s18 = 1.08664755E-31
       s19 = 0
       s20 = 7.16622809E+14
       s21 = -2.01102659E-11
       s22 = 3.42927887E+30
       s23 = -10.1882668
       s24 = -2.96600033E+26
       s25 = 1.06458477E-30
       s26 = -4.04634529E+19
       s27 = -3.58104799E-8
       s28 = 3.20526539E-8
       s29 = -0.303248763
       s30 = -92.8581085
       s31 = 0
        d0 = 0
        d1 = 5.9287877500949585E-323
        d2 = 7.9499288951273625E-275
        d3 = 0
        d4 = -322.69344342850582
        d5 = 1.2778464714478255E-88
        d6 = 8.5392762011492469E-297
        d7 = 9.3221474313448686E-96
        d8 = 0
        d9 = 0
       d10 = 0
       d11 = 0
       d12 = 0
       d13 = 0
       d14 = 0
       d15 = 0
       d16 = 4.9406564584124654E-324
       d17 = 9.8813129168249309E-324
       d18 = 5.9245434102707407E-270
       d19 = 0
       d20 = -322.69344342850582
       d21 = 1.2778464714478255E-88
       d22 = -2.7467518899128331E+156
       d23 = 4.3740614354224292E+186
       d24 = -4.6089062563314051E-60
       d25 = 1.1369246473020848E-74
       d26 = -5.2754580179824605E-252
       d27 = 2.7910890403839315E+176
       d28 = 8.9884238063464358E-285
       d29 = 2.9707604595813259E-226
       d30 = 1.0215140910834878E+55
       d31 = 0

Exception State Registers:
       far = 0x0000000000000000
       esr = 0xf2000000
  exception = 0x00000000

(lldb) image list
[  0] E0B57675-C7BC-3DFC-92D1-09DE4B4419B6 0x0000000100000000 /Users/sverker/gitrepos/akl-agents/emulator/oagents 
[  1] 398A133C-9BCB-317F-A064-A40D3CEA3C0F 0x000000018642a000 /usr/lib/dyld 
[  2] 62ADC8CE-D24A-3F00-8067-E7468EC6B815 0x00000001001a8000 /opt/homebrew/opt/gmp/lib/libgmp.10.dylib 
[  3] E7A14776-89AB-310A-9FCF-F47CAE8043B6 0x0000000194391000 /usr/lib/libSystem.B.dylib 
[  4] 46788F12-8B07-3253-BF23-C49BC753A327 0x000000019438b000 /usr/lib/system/libcache.dylib 
[  5] 1C8E15A6-869F-3AAD-AAE8-5825C7C4F902 0x0000000194344000 /usr/lib/system/libcommonCrypto.dylib 
[  6] F22CE10B-B1DF-3A58-9B8B-7F0ED73962DF 0x0000000194371000 /usr/lib/system/libcompiler_rt.dylib 
[  7] 0D18978A-4446-31EE-8228-25FABB44DB94 0x0000000194366000 /usr/lib/system/libcopyfile.dylib 
[  8] 8A08F4FE-C92E-35AA-BBB8-45A9D7A00AAD 0x0000000186517000 /usr/lib/system/libcorecrypto.dylib 
[  9] 5576E4FD-AAD2-3608-8C8F-4EEC421236F9 0x00000001865f9000 /usr/lib/system/libdispatch.dylib 
[ 10] C0C53058-94D2-3D9E-9E92-56BA8B43C327 0x00000001867b6000 /usr/lib/system/libdyld.dylib 
[ 11] 95E4D67C-51BF-36C9-99B5-35F5E2D6E2CA 0x0000000194381000 /usr/lib/system/libkeymgr.dylib 
[ 12] 9E0F73E3-1865-3F72-9ED1-465C68D23BA6 0x0000000194323000 /usr/lib/system/libmacho.dylib 
[ 13] 90D46A44-087C-3900-8509-EA90C6CFAD58 0x0000000193768000 /usr/lib/system/libquarantine.dylib 
[ 14] D242539B-BA45-363C-8B08-83FBCE4EC1C2 0x000000019437e000 /usr/lib/system/libremovefile.dylib 
[ 15] 26693E85-AFDC-38E2-B939-D6EC865FA506 0x000000018c3a8000 /usr/lib/system/libsystem_asl.dylib 
[ 16] A33D811C-BD2D-3833-9C38-9BF3960A1F8C 0x00000001864ac000 /usr/lib/system/libsystem_blocks.dylib 
[ 17] 92699527-645F-3D8D-AED8-1CFB0C034E15 0x0000000186643000 /usr/lib/system/libsystem_c.dylib 
[ 18] 74DC56B7-7BE5-3392-835A-7C6863986FF2 0x0000000194375000 /usr/lib/system/libsystem_collections.dylib 
[ 19] C218F939-9E60-37A3-B2EC-93837054946D 0x000000019284b000 /usr/lib/system/libsystem_configuration.dylib 
[ 20] A72C2FD5-969A-342F-B8A4-4216D7C7957E 0x000000019160e000 /usr/lib/system/libsystem_containermanager.dylib 
[ 21] 579E4601-365D-346F-9CD9-37851FB2874C 0x0000000193e77000 /usr/lib/system/libsystem_coreservices.dylib 
[ 22] F23DCA7C-AF18-3BB9-9D2F-FFBC4645DDC1 0x0000000189f01000 /usr/lib/system/libsystem_darwin.dylib 
[ 23] E3036CCB-95CF-3BD6-AA4F-58543B923EA5 0x000000026738a000 /usr/lib/system/libsystem_darwindirectory.dylib 
[ 24] 35DE5A07-AF58-33F0-A950-1F7CCAE85F3E 0x0000000194382000 /usr/lib/system/libsystem_dnssd.dylib 
[ 25] 4C8AC363-F171-3A08-85F8-7542B9C79A87 0x000000026738e000 /usr/lib/system/libsystem_eligibility.dylib 
[ 26] 64FD190D-C0D7-3B9A-837B-E63EA386BE14 0x0000000186640000 /usr/lib/system/libsystem_featureflags.dylib 
[ 27] 8C7C4902-FEC1-3776-87FF-2373BA19B1CE 0x00000001867eb000 /usr/lib/system/libsystem_info.dylib 
[ 28] 1B9E3C19-420A-38C5-96CE-6C2CE6EB56BA 0x00000001942e4000 /usr/lib/system/libsystem_m.dylib 
[ 29] 1480B446-99F7-3757-9D4E-5BA3014A2726 0x00000001865b7000 /usr/lib/system/libsystem_malloc.dylib 
[ 30] CD0C82E0-9B1B-3CAA-8CA7-466D1C439C3B 0x000000018c312000 /usr/lib/system/libsystem_networkextension.dylib 
[ 31] A3EE7CB1-6FCC-37AB-A8BC-256B9642B47D 0x000000018a364000 /usr/lib/system/libsystem_notify.dylib 
[ 32] BF38E17B-6A57-3EE2-A805-8E9B35542182 0x0000000192850000 /usr/lib/system/libsystem_sandbox.dylib 
[ 33] F0A7379E-6861-3B3F-BB56-1B08B1BEE98A 0x0000000267395000 /usr/lib/system/libsystem_sanitizers.dylib 
[ 34] 9BFA7CCC-E31E-3D39-832D-CA425269A795 0x000000019437a000 /usr/lib/system/libsystem_secinit.dylib 
[ 35] EEE9D0D3-DFFC-37CB-9CED-B27CD0286D8C 0x000000018676e000 /usr/lib/system/libsystem_kernel.dylib 
[ 36] 984D08B8-F85C-36F5-9E17-5BFF7FC779A3 0x00000001867e3000 /usr/lib/system/libsystem_platform.dylib 
[ 37] 642FAF7A-874E-37E6-8ABA-2B0CC09A3025 0x00000001867a9000 /usr/lib/system/libsystem_pthread.dylib 
[ 38] 695D143C-5D59-37B0-8784-4AE727AFEEF5 0x000000018deb1000 /usr/lib/system/libsystem_symptoms.dylib 
[ 39] 7F5EC174-AB45-37E7-B783-83A04B6154A1 0x00000001864fb000 /usr/lib/system/libsystem_trace.dylib 
[ 40] BEFBB85F-B46E-3C52-9A92-2F8EE957E3D9 0x0000000194352000 /usr/lib/system/libunwind.dylib 
[ 41] 564B7785-E7C4-3231-8BF1-3FBB266B6599 0x00000001864b0000 /usr/lib/system/libxpc.dylib 
[ 42] B2882096-462B-3878-BE2A-410F7B1A27FD 0x00000001863d8000 /usr/lib/libobjc.A.dylib 
[ 43] E7DBA219-4E97-307D-8E80-E0D97BE8517B 0x0000000186753000 /usr/lib/libc++abi.dylib 
[ 44] D8407F3E-5522-3C66-8A60-C29567136FD5 0x000000019435e000 /usr/lib/liboah.dylib 
[ 45] BBAB286C-2E51-3D64-9AE3-A4102935FE32 0x00000001866c5000 /usr/lib/libc++.1.dylib 
(lldb) # Print information about the current frame
(lldb) frame info
frame #0: 0x00000001000084e8 oagents`initialize_bignum
(lldb) # Print the source code context
(lldb) list
(lldb) # Try to identify what GMP function might be causing the issue
(lldb) image lookup --address 
error: last option requires an argument
(lldb) compilef('assoc').
error: 'compilef' is not a valid command.
